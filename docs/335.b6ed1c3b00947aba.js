"use strict";(self.webpackChunkmeanstacktemplate=self.webpackChunkmeanstacktemplate||[]).push([[335],{9335:(Jt,b,l)=>{l.r(b),l.d(b,{TaskModule:()=>Ut});var m=l(3075),Q=l(9764),C=l(9283),p=l(9808),h=l(1739),B=l(6027),g=l(6157),S=l(9470),_=l(5861),Z=l(7399),q=l(8675),z=l(4004),y=l(1079),D=l(2425),t=l(5542),A=l(2313),w=l(216),E=l(2265),M=l(2358),Y=l(457),P=l(508),F=l(7423),G=l(9224),x=l(6856),v=l(7322),U=l(5245),N=l(7531);const H=["category"],R=function(){return{value:2}};function K(s,i){1&s&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.hij(" ",t.xi3(2,1,"error.min-length",t.DdM(4,R))," "))}const $=function(){return{value:100}};function j(s,i){1&s&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.hij(" ",t.xi3(2,1,"error.max-length",t.DdM(4,$))," "))}const X=function(){return{value:300}};function W(s,i){1&s&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.hij(" ",t.xi3(2,1,"error.max-length",t.DdM(4,X))," "))}function V(s,i){if(1&s&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&s){const e=i.$implicit;t.Q6J("value",e.title),t.xp6(1),t.hij(" ",e.title," ")}}let O=(()=>{class s{constructor(e,a,o,n,r){this.bottomSheet=e,this.router=a,this.route=o,this.titleService=n,this.translateService=r,this.open()}open(){this.route.params.subscribe(e=>{this.bottomSheet.open(tt,{data:e.id?e.id:null}).afterDismissed().subscribe(()=>{this.translateService.get("title.tasks").subscribe(r=>this.titleService.setTitle(`${r} \u2014 Mean Stack Template`)),this.router.navigate(["tasks"])})})}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(Z.ch),t.Y36(g.F0),t.Y36(g.gz),t.Y36(A.Dx),t.Y36(h.sK))},s.\u0275cmp=t.Xpm({type:s,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,a){},encapsulation:2,changeDetection:0}),s})(),tt=(()=>{class s{constructor(e,a,o,n,r,c,u,k,T,Nt,Ot){this.changeDetector=e,this.taskService=a,this.categoryService=o,this.authService=n,this.formBuilder=r,this.bottomSheetRef=c,this.router=u,this.titleService=k,this.translateService=T,this.sharedService=Nt,this.id=Ot,this.isSaving=!1,this.form=this.formBuilder.group({title:[null,[m.kI.required,m.kI.minLength(2),m.kI.maxLength(100)]],description:[null,[m.kI.maxLength(300)]],date:[null,null],category:[null,null]})}ngOnInit(){var e=this;return(0,_.Z)(function*(){const a=!!e.id;if(e.sharedService.inputErrorListener.subscribe(()=>e.changeDetector.detectChanges()),a){e.translateService.get("title.edit-task").subscribe(u=>{e.title=u,e.titleService.setTitle(`${e.title} \u2014 Mean Stack Template`)});const[r,c]=yield e.sharedService.handlePromises(e.taskService.getTask(e.id));if(c||!r||null==r||!r.success)return e.sharedService.handleSnackbarMessages("task-form.get-error",!1);e.form.patchValue(r.data[0]),e.changeDetector.markForCheck()}else e.translateService.get("title.add-task").subscribe(r=>{e.title=r,e.titleService.setTitle(`${e.title} \u2014 Mean Stack Template`)});const[o,n]=yield e.sharedService.handlePromises(e.categoryService.listCategories());if(n||!o||null==o||!o.success)return e.sharedService.handleSnackbarMessages("task-form.get-error",!1);e.categories=o.data,e.setAutoCompletes()})()}ngAfterViewInit(){this.categoryTrigger.panelClosingActions.subscribe(()=>{this.categoryTrigger.activeOption&&this.form.controls.category.setValue(this.categoryTrigger.activeOption.value)})}_filterCategories(e){const a=null==e?void 0:e.toString().toLowerCase();return this.categories.filter(o=>o.title.toLowerCase().includes(a))}refresh(){this.changeDetector.detectChanges(),this.bottomSheetRef.dismiss()}saveAsync(){var e=this;return(0,_.Z)(function*(){if(!e.sharedService.isValidForm(e.form))return;const a=!!e.id,o={...e.form.value,userId:e.authService.getUserId(),_id:a?e.id:null};o.status=D.o.toDo;const[n,r]=yield e.sharedService.handlePromises(a?e.taskService.updateTask(o):e.taskService.createTask(o));if(r||!n||null==n||!n.success)return e.sharedService.handleSnackbarMessages(a?"task-form.edit-error":"task-form.create-error",!1);e.sharedService.handleSnackbarMessages(a?"task-form.edit-success":"task-form.create-success"),e.taskService.emitTask.emit(o),e.form.reset(),e.close()})()}close(){this.bottomSheetRef.dismiss(),this.form.reset(),this.router.navigate(["tasks"])}setAutoCompletes(){this.categoriesFilteredOptions=this.form.controls.category.valueChanges.pipe((0,q.O)(""),(0,z.U)(e=>this._filterCategories(e)))}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(t.sBO),t.Y36(w.M),t.Y36(E.H),t.Y36(M.e),t.Y36(m.qu),t.Y36(Z.oL),t.Y36(g.F0),t.Y36(A.Dx),t.Y36(h.sK),t.Y36(Y.F),t.Y36(Z.OG))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-task-form"]],viewQuery:function(e,a){if(1&e&&t.Gf(H,5,y.ZL),2&e){let o;t.iGM(o=t.CRH())&&(a.categoryTrigger=o.first)}},decls:46,vars:25,consts:[[1,"form-modal"],[1,"form-modal__header"],[1,"form-modal__header-wrapper"],["type","button","mat-fab","","color","primary",3,"click"],[1,"form-modal__header-title"],[1,"form-header"],["type","submit","mat-fab","","color","primary",3,"click"],[1,"form-modal__body"],[1,"form-modal__body-wrapper",3,"formGroup"],[1,"full-width"],["type","text","maxlength","100","formControlName","title","matInput","",3,"placeholder"],["taskTitle",""],["align","end"],[4,"ngIf"],["maxlength","300","formControlName","description","rows","2","matInput","",3,"placeholder"],["taskDescription",""],["formControlName","date","matInput","",3,"matDatepicker","focus"],["matSuffix","",3,"for"],["picker",""],["type","text","formControlName","category","matInput","",3,"placeholder","matAutocomplete"],["category",""],["categoriesAutocomplete","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return a.close()}),t.TgZ(4,"mat-icon"),t._uU(5,"close"),t.qZA()(),t.TgZ(6,"h2",4),t._uU(7),t.qZA(),t.TgZ(8,"div",5)(9,"button",6),t.NdJ("click",function(){return a.saveAsync()}),t.TgZ(10,"mat-icon"),t._uU(11,"check"),t.qZA()()()()(),t.TgZ(12,"div",7)(13,"form",8)(14,"mat-card-content")(15,"mat-form-field",9),t._UZ(16,"input",10,11),t.ALo(18,"translate"),t.TgZ(19,"mat-hint",12),t._uU(20),t.qZA(),t.YNc(21,K,3,5,"mat-error",13),t.YNc(22,j,3,5,"mat-error",13),t.qZA(),t.TgZ(23,"mat-form-field",9),t._UZ(24,"textarea",14,15),t.ALo(26,"translate"),t.TgZ(27,"mat-hint",12),t._uU(28),t.qZA(),t.YNc(29,W,3,5,"mat-error",13),t.qZA(),t.TgZ(30,"mat-form-field",9)(31,"mat-label"),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"input",16),t.NdJ("focus",function(){t.CHM(o);const r=t.MAs(37);return t.KtG(r.open())}),t.qZA(),t._UZ(35,"mat-datepicker-toggle",17)(36,"mat-datepicker",null,18),t.qZA(),t.TgZ(38,"mat-form-field",9),t._UZ(39,"input",19,20),t.ALo(41,"translate"),t.TgZ(42,"mat-autocomplete",null,21),t.YNc(44,V,2,2,"mat-option",22),t.ALo(45,"async"),t.qZA()()()()()()}if(2&e){const o=t.MAs(17),n=t.MAs(25),r=t.MAs(37),c=t.MAs(43);let u,k,T;t.xp6(7),t.Oqu(a.title),t.xp6(6),t.Q6J("formGroup",a.form),t.xp6(3),t.s9C("placeholder",t.lcZ(18,15,"input.title")),t.xp6(4),t.hij("",o.value.length||0,"/100"),t.xp6(1),t.Q6J("ngIf",null==(u=a.form.get("title"))?null:u.hasError("minlength")),t.xp6(1),t.Q6J("ngIf",null==(k=a.form.get("title"))?null:k.hasError("maxlength")),t.xp6(2),t.s9C("placeholder",t.lcZ(26,17,"input.description")),t.xp6(4),t.hij("",n.value.length||0,"/300"),t.xp6(1),t.Q6J("ngIf",null==(T=a.form.get("description"))?null:T.hasError("maxlength")),t.xp6(3),t.Oqu(t.lcZ(33,19,"input.choose-due-date")),t.xp6(2),t.Q6J("matDatepicker",r),t.xp6(1),t.Q6J("for",r),t.xp6(4),t.s9C("placeholder",t.lcZ(41,21,"input.category")),t.Q6J("matAutocomplete",c),t.xp6(5),t.Q6J("ngForOf",t.lcZ(45,23,a.categoriesFilteredOptions))}},dependencies:[p.sg,p.O5,m._Y,m.Fj,m.JJ,m.JL,m.nD,m.sg,m.u,y.XC,y.ZL,P.ey,F.lW,G.dn,x.Mq,x.hl,x.nW,v.TO,v.KE,v.bx,v.hX,v.R9,U.Hw,N.Nt,p.Ov,h.X$],changeDetection:0}),s})();var J=l(6087),L=l(4847),et=l(477),I=l(7093),f=l(2181),at=l(773),d=l(8279),st=l(7238),ot=l(393);let it=(()=>{class s{constructor(e){this.translateService=e}transform(e,a="mediumDate"){return new p.uU(this.translateService.currentLang).transform(e,a)}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(h.sK,16))},s.\u0275pipe=t.Yjl({name:"convertDate",type:s,pure:!1}),s})();const rt=["searchInput"];function nt(s,i){1&s&&(t.TgZ(0,"div",20),t._UZ(1,"mat-spinner",21),t.qZA())}function lt(s,i){1&s&&(t.TgZ(0,"div",22)(1,"div")(2,"mat-icon",23),t._uU(3,"sms"),t.qZA()(),t.TgZ(4,"div"),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&s&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"task-list.empty")))}function ct(s,i){1&s&&(t.TgZ(0,"div",22)(1,"div")(2,"mat-icon",23),t._uU(3,"sms"),t.qZA()(),t.TgZ(4,"div"),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&s&&(t.xp6(5),t.Oqu(t.lcZ(6,1,"task-list.empty-search")))}function mt(s,i){1&s&&(t.TgZ(0,"mat-cell",39)(1,"h3",40),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"table.date")))}function ut(s,i){if(1&s&&(t.TgZ(0,"mat-cell",41)(1,"h2"),t._uU(2),t.ALo(3,"convertDate"),t.TgZ(4,"p"),t._uU(5),t.ALo(6,"convertDate"),t.qZA()()()),2&s){const e=i.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,2,e.date,"EEEE")," "),t.xp6(3),t.Oqu(t.xi3(6,5,e.date,"shortDate"))}}function pt(s,i){1&s&&(t.TgZ(0,"mat-cell",39)(1,"h3",40),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"table.title")))}function dt(s,i){if(1&s&&(t.TgZ(0,"mat-cell",42),t._uU(1),t.qZA()),2&s){const e=i.$implicit;t.xp6(1),t.Oqu(e.title)}}function _t(s,i){1&s&&(t.TgZ(0,"mat-cell",39)(1,"h3",40),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"table.description")))}function ht(s,i){if(1&s&&(t.TgZ(0,"mat-cell",42),t._uU(1),t.qZA()),2&s){const e=i.$implicit;t.xp6(1),t.Oqu(e.description)}}function gt(s,i){1&s&&(t.TgZ(0,"mat-cell",39)(1,"h3",40),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"table.status")))}function vt(s,i){1&s&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"table.to-do")))}function ft(s,i){1&s&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"table.to-do")))}function kt(s,i){1&s&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"table.in-progress")))}function Tt(s,i){1&s&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"table.done")))}function Ct(s,i){if(1&s&&(t.TgZ(0,"mat-cell",42)(1,"div",43),t.YNc(2,vt,3,3,"div",44),t.YNc(3,ft,3,3,"div",45),t.YNc(4,kt,3,3,"div",45),t.YNc(5,Tt,3,3,"div",45),t.qZA()()),2&s){const e=i.$implicit;t.xp6(1),t.Q6J("ngSwitch",e.status),t.xp6(2),t.Q6J("ngSwitchCase","toDo"),t.xp6(1),t.Q6J("ngSwitchCase","progress"),t.xp6(1),t.Q6J("ngSwitchCase","done")}}function St(s,i){1&s&&(t.TgZ(0,"mat-cell",39)(1,"h3",40),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&s&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"table.category")))}function Zt(s,i){if(1&s&&(t.TgZ(0,"mat-cell",42),t._uU(1),t.qZA()),2&s){const e=i.$implicit;t.xp6(1),t.Oqu(e.category)}}function yt(s,i){1&s&&t._UZ(0,"mat-cell",46)}function At(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"mat-cell",42)(1,"button",47),t.NdJ("click",function(o){const r=t.CHM(e).$implicit,c=t.oxw(2);return c.changeStatusAsync(r,c.status.progress),t.KtG(o.stopPropagation())}),t.ALo(2,"translate"),t.TgZ(3,"mat-icon"),t._uU(4,"360 icon"),t.qZA()(),t.TgZ(5,"button",47),t.NdJ("click",function(o){const r=t.CHM(e).$implicit,c=t.oxw(2);return c.changeStatusAsync(r,c.status.done),t.KtG(o.stopPropagation())}),t.ALo(6,"translate"),t.TgZ(7,"mat-icon"),t._uU(8,"check"),t.qZA()(),t.TgZ(9,"button",47),t.NdJ("click",function(o){const r=t.CHM(e).$implicit;return t.oxw(2).removeAsync(r),t.KtG(o.stopPropagation())}),t.ALo(10,"translate"),t.TgZ(11,"mat-icon"),t._uU(12,"delete"),t.qZA()()()}2&s&&(t.xp6(1),t.s9C("matTooltip",t.lcZ(2,3,"table.actions.progress")),t.xp6(4),t.s9C("matTooltip",t.lcZ(6,5,"table.actions.done")),t.xp6(4),t.s9C("matTooltip",t.lcZ(10,7,"table.actions.remove")))}function xt(s,i){1&s&&t._UZ(0,"mat-cell",46)}function Lt(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"button",51),t.NdJ("click",function(o){t.CHM(e);const n=t.oxw().$implicit;return t.oxw(2).removeAsync(n),t.KtG(o.stopPropagation())}),t.TgZ(1,"span"),t._uU(2,"Remove"),t.qZA()()}}function bt(s,i){if(1&s&&(t.TgZ(0,"mat-cell",42)(1,"button",48),t.NdJ("click",function(a){return a.stopPropagation(),a.preventDefault()}),t.TgZ(2,"mat-icon"),t._uU(3,"more_vert"),t.qZA()(),t.TgZ(4,"mat-menu",null,49),t.YNc(6,Lt,3,0,"ng-template",50),t.qZA()()),2&s){const e=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",e)}}function Dt(s,i){1&s&&t._UZ(0,"mat-header-row",52)}function wt(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"mat-row",53),t.NdJ("click",function(o){const r=t.CHM(e).$implicit;return t.oxw(2).edit(r._id),t.KtG(o.stopPropagation())}),t.qZA()}}function Mt(s,i){if(1&s){const e=t.EpF();t.TgZ(0,"cdk-virtual-scroll-viewport",24)(1,"table",25),t.NdJ("matSortChange",function(o){t.CHM(e);const n=t.oxw();return t.KtG(n.sortDataAsync(o))}),t.ynx(2,26),t.YNc(3,mt,4,3,"mat-cell",27),t.YNc(4,ut,7,8,"mat-cell",28),t.BQk(),t.ynx(5,29),t.YNc(6,pt,4,3,"mat-cell",27),t.YNc(7,dt,2,1,"mat-cell",30),t.BQk(),t.ynx(8,31),t.YNc(9,_t,4,3,"mat-cell",27),t.YNc(10,ht,2,1,"mat-cell",30),t.BQk(),t.ynx(11,32),t.YNc(12,gt,4,3,"mat-cell",27),t.YNc(13,Ct,6,4,"mat-cell",30),t.BQk(),t.ynx(14,33),t.YNc(15,St,4,3,"mat-cell",27),t.YNc(16,Zt,2,1,"mat-cell",30),t.BQk(),t.ynx(17,34),t.YNc(18,yt,1,0,"mat-cell",35),t.YNc(19,At,13,9,"mat-cell",30),t.BQk(),t.ynx(20,36),t.YNc(21,xt,1,0,"mat-cell",35),t.YNc(22,bt,7,1,"mat-cell",30),t.BQk(),t.YNc(23,Dt,1,0,"mat-header-row",37),t.YNc(24,wt,1,0,"mat-row",38),t.qZA()()}if(2&s){const e=t.oxw();t.xp6(1),t.Q6J("hidden",e.isLoading||!e.tasks||!e.tasks.length)("dataSource",e.tasksDataSource),t.xp6(22),t.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",e.displayedColumns)}}const Yt=[{path:"",component:(()=>{class s{constructor(e,a,o,n,r,c,u){this.authService=e,this.changeDetector=a,this.taskService=o,this.sharedService=n,this.router=r,this.titleService=c,this.translateService=u,this.columnOptions={lgColumns:["date","title","description","status","category","actions"],mdColumns:["date","title","description","status","actions"],smColumns:["date","title","status","actions-mobile"],xsColumns:["date","title","status","actions-mobile"]},this.displayedColumns=this.columnOptions.lgColumns,this.title="Tasks",this.search="",this.searchedTasks=[],this.isLoading=!0,this.isSearching=!1,this.tasksDataSource=new C.kL,this.tasks=[],this.status=D.o,this.pageSize=10,this.pageCount=1,this.pageSizeOptions=[10,20,30],this.columnFilter="",this.columnDirection=""}ngOnInit(){this.updateTitle(),this.sharedService.setTableColumnsAndPagesize(this.displayedColumns,this.columnOptions,{pageSize:this.pageSize,pageSizeOptions:this.pageSizeOptions}),this.sharedService.tableColumnListener.subscribe(e=>this.displayedColumns=e),this.sharedService.pageSizeListener.subscribe(e=>{this.paginator.pageSize=e.pageSize,this.paginator.pageSizeOptions=e.pageSizeOptions}),this.refreshAsync(),this.taskService.emitTask.subscribe(()=>this.refreshAsync())}add(){this.router.navigate(["tasks/add"])}edit(e){this.router.navigate(["tasks/edit",e])}refreshAsync(){var e=this;return(0,_.Z)(function*(){const[a,o]=yield e.sharedService.handlePromises(e.taskService.listTasksByUser(e.pageSize));return o&&o.status===et.Z.ClientErrorUnauthorized?(e.authService.logoutAsync(),e.sharedService.handleSnackbarMessages("login.authentication-error",!1)):!o&&a&&null!=a&&a.success?(e.tasks=a.data,e.pageCount=a.totalCount,e.tasksDataSource=e.sharedService.setDataSource(e.tasks,e.sort,e.paginator),e.isLoading=!1,void e.changeDetector.markForCheck()):e.sharedService.handleSnackbarMessages("task-list.refresh-error",!1)})()}changeStatusAsync(e,a){var o=this;return(0,_.Z)(function*(){e.status=a;const[n,r]=yield o.sharedService.handlePromises(o.taskService.updateTask(e));if(r||!n||null==n||!n.success)return o.sharedService.handleSnackbarMessages("task-list.status-change-error",!1);o.sharedService.handleSnackbarMessages("task-list.status-change"),o.taskService.emitTask.emit(),o.changeDetector.markForCheck()})()}removeAsync(e){var a=this;return(0,_.Z)(function*(){const[o,n]=yield a.sharedService.handlePromises(a.taskService.removeTask(e._id));if(n||!o||null==o||!o.success)return a.sharedService.handleSnackbarMessages("task-list.remove-error",!1);a.sharedService.handleSnackbarMessages("task-list.remove-success"),a.taskService.emitTask.emit(),a.changeDetector.markForCheck()})()}onPaginateChangeAsync(e){var a=this;return(0,_.Z)(function*(){var o;a.isLoading=!0;const n=e.pageIndex,r=null!==(o=a.searchInput.nativeElement.value)&&void 0!==o?o:null;a.pageSize=e.pageSize;const[c,u]=yield a.sharedService.handlePromises(a.taskService.listTasksByUser(a.pageSize,r,n,a.columnFilter,a.columnDirection));if(u||!c||null==c||!c.success)return a.sharedService.handleSnackbarMessages("task-list.refresh-error",!1);a.tasks=c.data,a.pageCount=c.totalCount,a.tasksDataSource=a.sharedService.setDataSource(a.tasks),a.isLoading=!1,a.changeDetector.markForCheck()})()}sortDataAsync(e){var a=this;return(0,_.Z)(function*(){var o;a.isLoading=!0;const n=null!==(o=a.searchInput.nativeElement.value)&&void 0!==o?o:null;a.columnFilter=e.active,a.columnDirection=e.direction;const[r,c]=yield a.sharedService.handlePromises(a.taskService.listTasksByUser(a.pageSize,n,0,a.columnFilter,a.columnDirection));if(c||!r||null==r||!r.success)return a.sharedService.handleSnackbarMessages("task-list.refresh-error",!1);a.paginator.pageIndex=0,a.tasks=r.data,a.pageCount=r.totalCount,a.tasksDataSource=a.sharedService.setDataSource(a.tasks),a.isLoading=!1,a.changeDetector.markForCheck()})()}filterTasksAsync(e){var a=this;return(0,_.Z)(function*(){if(""===e)a.searchInput.nativeElement.value="",a.isSearching=!1,a.refreshAsync();else{a.isLoading=!0;const o=e.trim().toLowerCase(),[n,r]=yield a.sharedService.handlePromises(a.taskService.listTasksByUser(a.pageSize,o,0,a.columnFilter,a.columnDirection));if(r||!n||null==n||!n.success)return a.sharedService.handleSnackbarMessages("task-list.refresh-error",!1);a.paginator.pageIndex=0,a.tasks=n.data,a.pageCount=n.totalCount,a.tasksDataSource=a.sharedService.setDataSource(a.tasks),a.isLoading=!1,a.changeDetector.markForCheck()}})()}updateTitle(){this.translateService.get("title.tasks").subscribe(e=>this.titleService.setTitle(`${e} \u2014 Mean Stack Template`)),this.sharedService.emitTitle.subscribe(()=>this.updateTitle())}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(M.e),t.Y36(t.sBO),t.Y36(w.M),t.Y36(Y.F),t.Y36(g.F0),t.Y36(A.Dx),t.Y36(h.sK))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-task-list"]],viewQuery:function(e,a){if(1&e&&(t.Gf(L.YE,5),t.Gf(J.NW,5),t.Gf(rt,5)),2&e){let o;t.iGM(o=t.CRH())&&(a.sort=o.first),t.iGM(o=t.CRH())&&(a.paginator=o.first),t.iGM(o=t.CRH())&&(a.searchInput=o.first)}},decls:30,vars:21,consts:[[1,"page-container","page-container--table"],["fxLayoutAlign","center center",1,"list"],[1,"list__wrapper"],[1,"list__header"],[1,"list__header-title"],[1,"header-title"],["type","button","color","primary","mat-fab","",1,"list__header-button",3,"click"],[3,"matTooltip"],[1,"list__header-search","mat-elevation-z1"],["matInput","",3,"placeholder","value","keyup.enter"],["searchInput",""],["type","button","mat-icon-button",""],[3,"matTooltip","click"],[1,"list__body","mat-elevation-z1"],["class","loader","fxLayoutAlign","center center",4,"ngIf"],["class","list__body--empty","fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],[1,"table",3,"hidden"],["class","list__body-table","tvsItemSize","20",4,"ngIf"],[3,"hidden"],["showFirstLastButtons","",3,"length","pageSizeOptions","page"],["fxLayoutAlign","center center",1,"loader"],["mode","indeterminate","color","primary"],["fxLayout","column","fxLayoutAlign","center center",1,"list__body--empty"],[1,"icon","icon--big"],["tvsItemSize","20",1,"list__body-table"],["mat-table","","matSort","",3,"hidden","dataSource","matSortChange"],["matColumnDef","date"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","column-name","mat-cell","",4,"matCellDef"],["matColumnDef","title"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","status"],["matColumnDef","category"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","actions-mobile"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],[1,"list__body-title"],["mat-cell","",1,"column-name"],["mat-cell",""],[3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],["mat-header-cell",""],["type","button","mat-icon-button","",1,"list__body-actions",3,"matTooltip","click"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["menu","matMenu"],["matMenuContent",""],["type","button","mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return a.add()}),t.TgZ(9,"mat-icon",7),t.ALo(10,"translate"),t._uU(11,"add"),t.qZA()()(),t.TgZ(12,"div",8)(13,"mat-form-field")(14,"input",9,10),t.NdJ("keyup.enter",function(){t.CHM(o);const r=t.MAs(15);return t.KtG(a.filterTasksAsync(r.value))}),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"button",11)(18,"mat-icon",12),t.NdJ("click",function(){t.CHM(o);const r=t.MAs(15);return t.KtG(a.filterTasksAsync(r.value))}),t.ALo(19,"translate"),t._uU(20,"done"),t.qZA()()()(),t.TgZ(21,"div",13),t.YNc(22,nt,2,0,"div",14),t.YNc(23,lt,7,3,"div",15),t.YNc(24,ct,7,3,"div",15),t.TgZ(25,"div",16),t.YNc(26,Mt,25,5,"cdk-virtual-scroll-viewport",17),t.qZA(),t.TgZ(27,"div",18)(28,"mat-paginator",19),t.NdJ("page",function(r){return a.onPaginateChangeAsync(r)}),t.qZA()()()()()(),t._UZ(29,"router-outlet")}2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,13,"title.tasks")),t.xp6(3),t.s9C("matTooltip",t.lcZ(10,15,"task-list.title-tooltip")),t.xp6(5),t.MGl("placeholder","",t.lcZ(16,17,"task-list.search"),"..."),t.Q6J("value",a.search),t.xp6(4),t.s9C("matTooltip",t.lcZ(19,19,"task-list.search")),t.xp6(4),t.Q6J("ngIf",a.isLoading),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&0===(null==a.tasks?null:a.tasks.length)),t.xp6(1),t.Q6J("ngIf",!a.isLoading&&a.searchedTasks&&a.searchedTasks.length>0),t.xp6(1),t.Q6J("hidden",a.isLoading||!a.tasks.length||a.searchedTasks.length>0),t.xp6(1),t.Q6J("ngIf",a.tasks&&a.tasks.length>0),t.xp6(1),t.Q6J("hidden",a.isLoading||a.tasks&&0===a.tasks.length),t.xp6(1),t.Q6J("length",a.pageCount)("pageSizeOptions",a.pageSizeOptions))},dependencies:[g.lC,p.O5,p.RF,p.n9,p.ED,I.xw,I.Wh,F.lW,v.KE,U.Hw,N.Nt,f.VK,f.OP,f.p6,f.KA,J.NW,at.Ou,L.YE,L.nU,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ev,d.XQ,d.Gk,st.gM,ot.N7,C.So,h.X$,it],changeDetection:0}),s})(),canActivate:[S.a],children:[{path:"add",component:O,canActivate:[S.a]},{path:"edit/:id",component:O,canActivate:[S.a]}]}];let Ft=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[g.Bz.forChild(Yt),g.Bz]}),s})(),Ut=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[Ft,p.ez,m.u5,m.UX,Q.o9,B.h,C.oJ,h.aw]}),s})()}}]);